(function(){"use strict";var e={655:function(e,s,t){var a=t(963),i=t(252);function n(e,s,t,a,n,l){const o=(0,i.up)("chat");return(0,i.wg)(),(0,i.j4)(o)}const l={key:1};function o(e,s,t,n,o,r){const h=(0,i.up)("user-chat-low"),d=(0,i.up)("LogChat"),c=(0,i.up)("UserChat");return(0,i.wg)(),(0,i.j4)(a.uT,{name:"fade"},{default:(0,i.w5)((()=>[o.isHigh?((0,i.wg)(),(0,i.iD)("div",l,[o.isIn?((0,i.wg)(),(0,i.j4)(c,{key:1,isHigh:o.isHigh,onLogOut:r.logOut,onCollapse:r.chiba},null,8,["isHigh","onLogOut","onCollapse"])):((0,i.wg)(),(0,i.j4)(d,{key:0,onIsLogOk:r.userLogging,onCollapse:r.chiba},null,8,["onIsLogOk","onCollapse"]))])):((0,i.wg)(),(0,i.j4)(h,{key:0,onSetLow:r.chiba},null,8,["onSetLow"]))])),_:1})}var r={data(){return{myProxy:"http://31.28.9.200:23765"}},methods:{dateFocuses(){let e=new Date,s=e.getFullYear().toString(),t=e.getMonth()+1,a=e.getDate().toString(),i=e.getHours().toString(),n=e.getMinutes().toString(),l=e.getSeconds().toString();a<10&&(a="0"+a),t<10&&(t="0"+t.toString()),i<10&&(i="0"+i),n<10&&(n="0"+n),l<10&&(l="0"+l);const o=s+"-"+t+"-"+a+" "+i+":"+n+":"+l;return o},isImage(e){if(null!==e)return".jpg"===e.substr(-4)||".gif"===e.substr(-4)||".png"===e.substr(-4)||"jpeg"===e.substr(-4)},scrollToEnd(){this.$refs.chatter.scrollTop=this.$refs.chatter.scrollHeight}}},h=t(577);const d=e=>((0,i.dD)("data-v-c3faab70"),e=e(),(0,i.Cn)(),e),c=["fill"],g=d((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M.172 15.828a.5.5 0 0 0 .707 0l4.096-4.096V14.5a.5.5 0 1 0 1 0v-3.975a.5.5 0 0 0-.5-.5H1.5a.5.5 0 0 0 0 1h2.768L.172 15.121a.5.5 0 0 0 0 .707zM15.828.172a.5.5 0 0 0-.707 0l-4.096 4.096V1.5a.5.5 0 1 0-1 0v3.975a.5.5 0 0 0 .5.5H14.5a.5.5 0 0 0 0-1h-2.768L15.828.879a.5.5 0 0 0 0-.707z"},null,-1))),u=[g],m={class:"login__form__inner"},p=d((()=>(0,i._)("h1",null,"Регистрация",-1))),_=d((()=>(0,i._)("label",{for:"username"},"Имя (2-15 символов)",-1)));function f(e,s,t,n,l,o){return(0,i.wg)(),(0,i.iD)("div",{class:"login",style:(0,h.j5)({backgroundColor:e.mainColor})},[(0,i._)("header",null,[(0,i._)("button",{class:"login__collapse-button",onClick:s[0]||(s[0]=e=>this.$emit("collapse"))},[((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:e.mainTextColor,class:"bi bi-arrows-angle-contract",viewBox:"0 0 16 16"},u,8,c))])]),(0,i._)("form",{class:"login__form",onSubmit:s[3]||(s[3]=(0,a.iM)(((...e)=>o.logIn&&o.logIn(...e)),["prevent"]))},[(0,i._)("div",m,[p,_,(0,i.wy)((0,i._)("input",{id:"username",type:"text","onUpdate:modelValue":s[1]||(s[1]=e=>l.username=e),placeholder:"Введите имя..."},null,512),[[a.nr,l.username]]),(0,i.wy)((0,i._)("input",{id:"email",type:"text","onUpdate:modelValue":s[2]||(s[2]=e=>l.email=e),placeholder:"Введите адрес почты"},null,512),[[a.nr,l.email]]),(0,i._)("input",{style:(0,h.j5)({backgroundColor:e.mainColor,color:e.mainTextColor}),type:"submit",value:"Войти"},null,4),(0,i._)("p",null,(0,h.zw)(l.logError),1)])],32)],4)}var w=t(669),v=t.n(w),C=t(907),y={data(){return{username:null,logError:null,isIn:!1,userId:null,email:null,messages:[]}},mixins:[r],methods:{checkAuth(){"undefined"!==sessionStorage.getItem("user_id")&&sessionStorage.getItem("user_id")?(this.username=sessionStorage.getItem("user_name"),this.$emit("isLogOk",!0)):this.$emit("isLogOk",!1)},async logIn(){if(this.email||this.username)if(this.username=this.username.trim(),!this.username||this.username.length>15||this.username.length<2)this.logError="Введите верное имя";else if(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(this.email)){this.logError=null;const e={params:{name:this.username,email:this.email}};console.log("Starting"),await v().post(`${this.myProxy}/api/users/add`,null,e).then((e=>{e.data.error?(console.log(e.data.error),"User banned"===e.data.error?this.logError="Вы заблокированы":this.logError="Введите верное имя",this.$emit("isLogOk",!1)):(console.log("all is ok"),console.log(e.data),sessionStorage.setItem("user_id",e.data.id),sessionStorage.setItem("user_email",e.data.email),sessionStorage.setItem("user_name",e.data.name),sessionStorage.setItem("user_status",e.data.status),this.checkAuth())}))}else this.logError="Неправильный email!";else this.logError="Введите имя!"}},computed:{...(0,C.rn)({mainColor:e=>e.styleForUser.mainColor,mainTextColor:e=>e.styleForUser.mainTextColor})}},b=t(744);const k=(0,b.Z)(y,[["render",f],["__scopeId","data-v-c3faab70"]]);var M=k;function S(e,s,t,a,n,l){const o=(0,i.up)("user-chat-header"),r=(0,i.up)("user-chat-messages"),d=(0,i.up)("user-chat-type-message");return(0,i.wg)(),(0,i.iD)("div",{class:"chat",style:(0,h.j5)({backgroundColor:e.mainColor})},[(0,i.Wm)(o,{onCollapse:l.chiba,onLogOutUserChat:l.logOutUC},null,8,["onCollapse","onLogOutUserChat"]),(0,i.Wm)(r,{newMessage:n.myNewMessage},null,8,["newMessage"]),(0,i.Wm)(d,{onSendMessage:l.sendingMessage},null,8,["onSendMessage"])],4)}const L=e=>((0,i.dD)("data-v-58e590c9"),e=e(),(0,i.Cn)(),e),I=["fill"],U=L((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M.172 15.828a.5.5 0 0 0 .707 0l4.096-4.096V14.5a.5.5 0 1 0 1 0v-3.975a.5.5 0 0 0-.5-.5H1.5a.5.5 0 0 0 0 1h2.768L.172 15.121a.5.5 0 0 0 0 .707zM15.828.172a.5.5 0 0 0-.707 0l-4.096 4.096V1.5a.5.5 0 1 0-1 0v3.975a.5.5 0 0 0 .5.5H14.5a.5.5 0 0 0 0-1h-2.768L15.828.879a.5.5 0 0 0 0-.707z"},null,-1))),O=[U],x=["fill"],D=L((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0v-2z"},null,-1))),B=L((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"},null,-1))),A=[D,B];function T(e,s,t,a,n,l){return(0,i.wg)(),(0,i.iD)("header",null,[(0,i._)("button",{class:"header__buttons",onClick:s[0]||(s[0]=(...e)=>l.chiba&&l.chiba(...e))},[((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:e.mainTextColor,class:"bi bi-arrows-angle-contract",viewBox:"0 0 16 16"},O,8,I))]),(0,i._)("button",{class:"logout",onClick:s[1]||(s[1]=(...e)=>l.logOutHeader&&l.logOutHeader(...e))},[((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:e.mainTextColor,class:"bi bi-box-arrow-in-right",viewBox:"0 0 16 16"},A,8,x))]),(0,i._)("h1",{style:(0,h.j5)({color:e.mainTextColor}),class:"header__greeting"}," Здравствуйте, "+(0,h.zw)(n.username),5)])}var z={data(){return{username:sessionStorage.getItem("user_name")}},methods:{chiba(){this.$emit("collapse")},logOutHeader(){this.$emit("logOutUserChat")}},computed:{...(0,C.rn)({mainTextColor:e=>e.styleForUser.mainTextColor})}};const F=(0,b.Z)(z,[["render",T],["__scopeId","data-v-58e590c9"]]);var H=F;const $=e=>((0,i.dD)("data-v-43003dee"),e=e(),(0,i.Cn)(),e),P={key:0},j={class:"user-message-history__messages-list__message-inner"},N={class:"user-message-history__messages-list__message-inner__username"},V=["href"],Z=["src"],E=["href"],Y=$((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-cloud-arrow-down",viewBox:"0 0 16 16"},[(0,i._)("path",{"fill-rule":"evenodd",d:"M7.646 10.854a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 9.293V5.5a.5.5 0 0 0-1 0v3.793L6.354 8.146a.5.5 0 1 0-.708.708l2 2z"}),(0,i._)("path",{d:"M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"})],-1)));function K(e,s,t,a,n,l){return(0,i.wg)(),(0,i.iD)("section",{class:"user-message-history",ref:"chatter",style:(0,h.j5)({backgroundColor:e.mainBackColor})},[n.isBanned?((0,i.wg)(),(0,i.iD)("p",P," Вы заблокированы и не можете отправлять сообщения ")):!n.isBanned&&n.isLoading?((0,i.wg)(),(0,i.iD)("div",{key:1,style:(0,h.j5)(`border-top: 16px solid ${e.mainColor}`),class:"user-message-history__loader"},null,4)):((0,i.wg)(!0),(0,i.iD)(i.HY,{key:2},(0,i.Ko)(n.messages,(s=>((0,i.wg)(),(0,i.iD)("div",{class:(0,h.C_)(["user-message-history__messages-list","User"===s.role?"current-user":null])},[(0,i._)("div",j,[(0,i._)("div",N,[(0,i._)("p",{style:(0,h.j5)({color:e.usernameColor})},(0,h.zw)(s.name),5)]),(0,i._)("div",{style:(0,h.j5)("User"===s.role?{backgroundColor:e.mainColor,color:e.mainTextColor}:{backgroundColor:e.adminMsgBackCol,color:e.adminMsgFontCol}),class:"user-message-history__messages-list__message-inner__content"},[(0,i._)("p",null,(0,h.zw)(s.message),1),0!==s.file.length?((0,i.wg)(!0),(0,i.iD)(i.HY,{key:0},(0,i.Ko)(s.file,((t,a)=>((0,i.wg)(),(0,i.iD)("div",{key:t.id},[e.isImage(s.file[a].name)?((0,i.wg)(),(0,i.iD)("a",{key:0,href:l.getFiles(s.file[a].name),target:"_blank"},[(0,i._)("img",{class:"user-message-history__messages-list__message-inner__content__img",src:l.getFiles(s.file[a].name)},null,8,Z)],8,V)):((0,i.wg)(),(0,i.iD)("a",{key:1,href:l.getFiles(s.file[a].name),class:"user-message-history__messages-list__message-inner__content__links",target:"_blank"},[Y,(0,i.Uk)(" "+(0,h.zw)(s.file[a].name),1)],8,E))])))),128)):(0,i.kq)("",!0)],4)])],2)))),256))],4)}var R={data(){return{isLoading:!0,messages:[],isBanned:!1}},mixins:[r],props:{newMessage:{type:Object,default:null}},methods:{getFiles(e){const s=this.myProxy+"/api/file/"+e;return s},checkStatus(){"Banned"===sessionStorage.getItem("user_status")?this.isBanned=!0:this.isBanned=!1},async getMessages(){if(this.checkStatus(),!this.isBanned){const e={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{user_id:sessionStorage.getItem("user_id")}};console.log(e),await v().get(`${this.myProxy}/api/users/messages`,e).then((e=>{if(console.log(e),e.data.error)alert("ошибка соединения");else{this.messages=[];let s={};for(let t=0;t<e.data.length;t++)s={user_id:e.data[t].user_id,name:"Admin"===e.data[t].status?"Admin":sessionStorage.getItem("user_name"),message:e.data[t].message,role:"Admin"===e.data[t].status?"Admin":"User",file:e.data[t].file},this.messages.push(s);this.isLoading=!1}}))}},addNewMessage(){this.messages.push(this.newMessage)}},created(){this.getMessages()},watch:{newMessage(){this.addNewMessage()},messages:{handler(e,s){setTimeout(this.scrollToEnd,200)},deep:!0}},computed:{...(0,C.rn)({mainColor:e=>e.styleForUser.mainColor,mainTextColor:e=>e.styleForUser.mainTextColor,adminMsgBackCol:e=>e.styleForUser.adminMsgBackCol,adminMsgFontCol:e=>e.styleForUser.adminMsgFontCol,usernameColor:e=>e.styleForUser.usernameColor,mainBackColor:e=>e.styleForUser.mainBackColor})}};const G=(0,b.Z)(R,[["render",K],["__scopeId","data-v-43003dee"]]);var Q=G;const q=e=>((0,i.dD)("data-v-64b26db0"),e=e(),(0,i.Cn)(),e),J={class:"input-msg-form__butt"},X=q((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"16",fill:"currentColor",class:"bi bi-arrow-right",viewBox:"0 0 16 16"},[(0,i._)("path",{"fill-rule":"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"})],-1))),W=[X],ee=q((()=>(0,i._)("input",{type:"submit",id:"subBut",value:"Отпр."},null,-1))),se=q((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"16",fill:"currentColor",class:"bi bi-folder-symlink",viewBox:"0 0 16 16"},[(0,i._)("path",{d:"m11.798 8.271-3.182 1.97c-.27.166-.616-.036-.616-.372V9.1s-2.571-.3-4 2.4c.571-4.8 3.143-4.8 4-4.8v-.769c0-.336.346-.538.616-.371l3.182 1.969c.27.166.27.576 0 .742z"}),(0,i._)("path",{d:"m.5 3 .04.87a1.99 1.99 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14h10.348a2 2 0 0 0 1.991-1.819l.637-7A2 2 0 0 0 13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2zm.694 2.09A1 1 0 0 1 2.19 4h11.62a1 1 0 0 1 .996 1.09l-.636 7a1 1 0 0 1-.996.91H2.826a1 1 0 0 1-.995-.91l-.637-7zM6.172 2a1 1 0 0 1 .707.293L7.586 3H2.19c-.24 0-.47.042-.683.12L1.5 2.98a1 1 0 0 1 1-.98h3.672z"})],-1))),te=[se],ae={class:"files-area"};function ie(e,s,t,n,l,o){return(0,i.wg)(),(0,i.iD)("footer",null,[(0,i._)("form",{class:"input-msg-form",onSubmit:s[3]||(s[3]=(0,a.iM)(((...e)=>o.sendMessage&&o.sendMessage(...e)),["prevent"]))},[(0,i.wy)((0,i._)("textarea",{ref:"inpMes",onKeyup:s[0]||(s[0]=(0,a.D2)(((...e)=>o.sendMessage&&o.sendMessage(...e)),["enter"])),"onUpdate:modelValue":s[1]||(s[1]=e=>l.userMessage=e),rows:"2",cols:"4",placeholder:"Написать сообщение..."},null,544),[[a.nr,l.userMessage]]),(0,i._)("div",J,[(0,i._)("label",{style:(0,h.j5)({backgroundColor:e.mainColor,color:e.mainTextColor}),for:"subBut"},W,4),ee,(0,i._)("label",{style:(0,h.j5)({backgroundColor:e.mainColor,color:e.mainTextColor}),for:"fileUp"},te,4),(0,i._)("input",{ref:"file",onChange:s[2]||(s[2]=(...e)=>o.handleFileUpload&&o.handleFileUpload(...e)),id:"fileUp",type:"file"},null,544)])],32),l.files.length>0?((0,i.wg)(!0),(0,i.iD)(i.HY,{key:0},(0,i.Ko)(l.files,(e=>((0,i.wg)(),(0,i.iD)("div",ae,[(0,i._)("p",null,(0,h.zw)(e.name)+" ",1)])))),256)):(0,i.kq)("",!0)])}var ne={data(){return{files:[],userMessage:""}},mixins:[r],methods:{sendMessage(){let e=[];if(this.files.length>0)console.log("with files"),this.files.forEach((s=>{e.push(s.name)})),""!==this.userMessage&&(this.userMessage=this.userMessage.trim());else if(e=[],""===this.userMessage||"\n"===this.userMessage)return this.userMessage="",void alert("Введите сообщение");let s={name:sessionStorage.getItem("user_name"),user_id:sessionStorage.getItem("user_id"),message:this.userMessage,status:"User",role:"User",date:this.dateFocuses(),file:e};this.$socket.emit("user_message",s),s={name:sessionStorage.getItem("user_name"),user_id:sessionStorage.getItem("user_id"),message:this.userMessage,status:"User",role:"User",date:this.dateFocuses(),file:this.files},console.log(s),this.$emit("sendMessage",s),this.userMessage="",this.files=[],console.log("Сообщение отправлено")},async handleFileUpload(){let e=new FormData;e.append("file",this.$refs.file.files[0]),console.log(this.$refs.file.files[0]),await v().post(`${this.myProxy}/api/file/upload`,e,{headers:{"Content-type":"multipart/form-data"}}).then((s=>{console.log(s),console.log("Успешно отправлен файл");let t={name:s.data,file:e,fileURL:window.URL.createObjectURL(this.$refs.file.files[0])};this.files.push(t)})).catch((e=>{console.log(e)}))}},computed:{...(0,C.rn)({mainColor:e=>e.styleForUser.mainColor,mainTextColor:e=>e.styleForUser.mainTextColor})}};const le=(0,b.Z)(ne,[["render",ie],["__scopeId","data-v-64b26db0"]]);var oe=le,re={components:{UserChatHeader:H,UserChatMessages:Q,UserChatTypeMessage:oe},data(){return{username:null,myNewMessage:null}},mixins:[r],methods:{soundNotification(){let e=new Audio;e.src="https://ringon.site/?do=get-file&id=34361",e.volume=.3,e.play()},userResponce(){this.$socket.emit("connected",{id:sessionStorage.getItem("user_id")}),this.sockets.subscribe("user_response",(e=>{if(e.error)"User banned"===e.error&&(sessionStorage.setItem("user_status","Banned"),this.chiba()),console.log(e.error);else{console.log("Сообщение получено");let s=[];for(let a=0;a<e.file.length;a++)s.push({name:e.file[a]});const t={name:"Admin",message:e.message,role:"Admin",file:s};console.log(t),this.myNewMessage=t,this.soundNotification()}}))},chiba(){this.$emit("collapse")},logOutUC(){this.$emit("logOut")},sendingMessage(e){this.myNewMessage=e},checkAuth(){"undefined"!==sessionStorage.getItem("user_id")&&null!==sessionStorage.getItem("user_id")?(this.username=sessionStorage.getItem("user_name"),this.$emit("isLogOk",!0),this.userResponce()):this.$emit("isLogOk",!1)}},mounted(){this.checkAuth()},computed:{...(0,C.rn)({mainColor:e=>e.styleForUser.mainColor})}};const he=(0,b.Z)(re,[["render",S],["__scopeId","data-v-08a15d01"]]);var de=he;const ce=e=>((0,i.dD)("data-v-225aa1f0"),e=e(),(0,i.Cn)(),e),ge=["fill"],ue=ce((()=>(0,i._)("path",{d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm5.904-2.803a.5.5 0 1 0-.707.707L9.293 10H6.525a.5.5 0 0 0 0 1H10.5a.5.5 0 0 0 .5-.5V6.525a.5.5 0 0 0-1 0v2.768L5.904 5.197z"},null,-1))),me=[ue],pe=(0,i.Uk)(" Жмакни "),_e=["fill"],fe=ce((()=>(0,i._)("path",{d:"M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"},null,-1))),we=ce((()=>(0,i._)("path",{d:"m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9.06 9.06 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.437 10.437 0 0 1-.524 2.318l-.003.011a10.722 10.722 0 0 1-.244.637c-.079.186.074.394.273.362a21.673 21.673 0 0 0 .693-.125zm.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6c0 3.193-3.004 6-7 6a8.06 8.06 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a10.97 10.97 0 0 0 .398-2z"},null,-1))),ve=[fe,we];function Ce(e,s,t,a,n,l){return(0,i.wg)(),(0,i.iD)(i.HY,null,["default"===e.chatIconType?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"lowbe",style:(0,h.j5)({backgroundColor:e.mainColor}),onClick:s[0]||(s[0]=e=>this.$emit("setLow"))},[(0,i._)("p",{style:(0,h.j5)({color:e.mainTextColor})},[((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:e.mainTextColor,class:"bi bi-arrow-down-right-circle-fill",viewBox:"0 0 16 16"},me,8,ge)),pe],4)],4)):(0,i.kq)("",!0),"circle"===e.chatIconType?((0,i.wg)(),(0,i.iD)("div",{key:1,class:"lowbe-round",style:(0,h.j5)({backgroundColor:e.mainColor}),onClick:s[1]||(s[1]=e=>this.$emit("setLow"))},[((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"65%",height:"65%",fill:e.mainTextColor,class:"bi bi-chat-dots",viewBox:"0 0 16 16"},ve,8,_e))],4)):(0,i.kq)("",!0)],64)}var ye={computed:{...(0,C.rn)({mainColor:e=>e.styleForUser.mainColor,mainTextColor:e=>e.styleForUser.mainTextColor,chatIconType:e=>e.styleForUser.chatIconType})}};const be=(0,b.Z)(ye,[["render",Ce],["__scopeId","data-v-225aa1f0"]]);var ke=be,Me={components:{LogChat:M,UserChat:de,UserChatLow:ke},mixins:[r],data(){return{connection:null,username:null,messages:[],userMessage:null,isHigh:!1,logError:null,isIn:!1,userId:null,email:null}},sockets:{connect:function(){console.log("socket connected")}},methods:{...(0,C.nv)({getSiteId:"styleForUser/getSiteId"}),chiba(){this.isHigh=!this.isHigh,localStorage.setItem("chatIsFulled",this.isHigh)},logOut(){console.log("дисконнектюсь"),this.sockets.unsubscribe("message_response"),sessionStorage.clear(),this.isIn=!1},userLogging(e){this.isIn=e},checkAuth(){"undefined"!==sessionStorage.getItem("user_id")&&null!==sessionStorage.getItem("user_id")?(this.username=sessionStorage.getItem("user_name"),this.isIn=!0):this.isIn=!1}},mounted(){this.checkAuth()},created(){console.log(window.location.host),this.getSiteId(window.location.host)},computed:{...(0,C.rn)({mainColor:e=>e.styleForUser.mainColor})}};const Se=(0,b.Z)(Me,[["render",o],["__scopeId","data-v-106853dd"]]);var Le=Se;function Ie(e,s,t,a,n,l){const o=(0,i.up)("registrationAdmin"),r=(0,i.up)("AdminChat");return n.isIn?((0,i.wg)(),(0,i.j4)(r,{key:1,onClose:l.adminClose},null,8,["onClose"])):((0,i.wg)(),(0,i.j4)(o,{key:0,onAuth:l.checkAuth},null,8,["onAuth"]))}const Ue=e=>((0,i.dD)("data-v-0186b900"),e=e(),(0,i.Cn)(),e),Oe={class:"messenger"},xe={key:0,class:"messenger__clients"},De=Ue((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"white",class:"bi bi-chevron-double-right",viewBox:"0 0 16 16"},[(0,i._)("path",{"fill-rule":"evenodd",d:"M3.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L9.293 8 3.646 2.354a.5.5 0 0 1 0-.708z"}),(0,i._)("path",{"fill-rule":"evenodd",d:"M7.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L13.293 8 7.646 2.354a.5.5 0 0 1 0-.708z"})],-1))),Be=[De],Ae={key:2,class:"all-collapse"},Te=Ue((()=>(0,i._)("h1",null,[(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"2.5rem",height:"2.5rem",fill:"currentColor",class:"bi bi-caret-left",viewBox:"0 0 16 16"},[(0,i._)("path",{d:"M10 12.796V3.204L4.519 8 10 12.796zm-.659.753-5.48-4.796a1 1 0 0 1 0-1.506l5.48-4.796A1 1 0 0 1 11 3.204v9.592a1 1 0 0 1-1.659.753z"})]),(0,i.Uk)("Выберите пользователя чтобы начать с ним диалог ")],-1))),ze=[Te];function Fe(e,s,t,a,n,l){const o=(0,i.up)("admin-clients-header"),r=(0,i.up)("admin-style-changer"),d=(0,i.up)("admin-clients-list"),c=(0,i.up)("admin-messages"),g=(0,i.up)("admin-write-message");return(0,i.wg)(),(0,i.iD)("div",Oe,[n.clientOpen?((0,i.wg)(),(0,i.iD)("div",xe,[(0,i.Wm)(o,{onMessOpen:l.openClients,onClose:l.toClose,onStatus:l.changeStatus,onUpdateSearchQuery:l.searchRequest,onChangeStyleChat:l.openChangeStyle},null,8,["onMessOpen","onClose","onStatus","onUpdateSearchQuery","onChangeStyleChat"]),n.isChangingStyleOpen?((0,i.wg)(),(0,i.j4)(r,{key:0})):((0,i.wg)(),(0,i.j4)(d,{key:1,onOpenMessage:l.openMessages,chosenStatus:n.chosenStatus,newLastMessage:n.lastMessageToUpdate,newClient:n.addNewUser,endDialogUserId:n.userIdEndDialog,searchText:n.searchQueryText},null,8,["onOpenMessage","chosenStatus","newLastMessage","newClient","endDialogUserId","searchText"]))])):((0,i.wg)(),(0,i.iD)("div",{key:1,class:"messenger__clients-collapse",onClick:s[0]||(s[0]=e=>n.clientOpen=!n.clientOpen)},Be)),n.clientOpen||n.isMessageOpen?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",Ae,ze)),(0,i._)("div",{class:"messenger__messages",style:(0,h.j5)({display:n.isMessageOpen?n.db:n.dn})},[(0,i.Wm)(c,{chosenStatus:n.chosenStatus,userId:n.messagesUserId,sendMessage:n.lastMessageToUpdate,onEndDialog:l.endDialog},null,8,["chosenStatus","userId","sendMessage","onEndDialog"]),(0,i.Wm)(g,{onUpdateLastMessage:l.updateClientList,chsAct:n.messagesUserId},null,8,["onUpdateLastMessage","chsAct"])],4)])}const He=e=>((0,i.dD)("data-v-88588c44"),e=e(),(0,i.Cn)(),e),$e={class:"clients-header"},Pe={class:"clients-header__topic"},je=(0,i.Uk)("Клиенты "),Ne={key:0,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-double-right",viewBox:"0 0 16 16"},Ve=He((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M3.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L9.293 8 3.646 2.354a.5.5 0 0 1 0-.708z"},null,-1))),Ze=He((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M7.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L13.293 8 7.646 2.354a.5.5 0 0 1 0-.708z"},null,-1))),Ee=[Ve,Ze],Ye={key:1,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-double-left",viewBox:"0 0 16 16"},Ke=He((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M8.354 1.646a.5.5 0 0 1 0 .708L2.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"},null,-1))),Re=He((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M12.354 1.646a.5.5 0 0 1 0 .708L6.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"},null,-1))),Ge=[Ke,Re],Qe={class:"clients-header__seach-bar"},qe=He((()=>(0,i._)("span",{class:"clients-header__input-group-addon"},[(0,i._)("button",{type:"button"},[(0,i._)("i",{class:"fa fa-search","aria-hidden":"true"})])],-1))),Je={class:"status_list"};function Xe(e,s,t,n,l,o){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",$e,[(0,i._)("div",Pe,[(0,i._)("h4",{onClick:s[0]||(s[0]=(...e)=>o.visClients&&o.visClients(...e))},[je,l.clientOpen?((0,i.wg)(),(0,i.iD)("svg",Ye,Ge)):((0,i.wg)(),(0,i.iD)("svg",Ne,Ee))]),(0,i._)("h4",{onClick:s[1]||(s[1]=(...e)=>o.toClose&&o.toClose(...e))},"Выход")]),(0,i._)("div",Qe,[(0,i._)("h4",{onClick:s[2]||(s[2]=(...e)=>o.toChangeStyle&&o.toChangeStyle(...e))},"Дизайн чата"),(0,i._)("div",null,[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>l.searchQuery=e),type:"text",placeholder:"Поиск"},null,512),[[a.nr,l.searchQuery]]),qe])])]),(0,i._)("div",Je,[(0,i._)("ul",null,[(0,i._)("li",{onClick:s[4]||(s[4]=(0,a.iM)((e=>l.chosenStatus=1),["prevent"])),class:(0,h.C_)({activeStatus:1===l.chosenStatus})},"Активные",2),(0,i._)("li",{onClick:s[5]||(s[5]=(0,a.iM)((e=>l.chosenStatus=2),["prevent"])),class:(0,h.C_)({activeStatus:2===l.chosenStatus})},"Законченные",2),(0,i._)("li",{onClick:s[6]||(s[6]=(0,a.iM)((e=>l.chosenStatus=3),["prevent"])),class:(0,h.C_)({activeStatus:3===l.chosenStatus})},"Бан",2)])])],64)}var We={data(){return{clientOpen:!0,searchQuery:"",chosenStatus:1}},methods:{toClose(){this.$emit("close")},visClients(){this.clientOpen=!this.clientOpen,this.$emit("messOpen",this.clientOpen)},toChangeStyle(){this.$emit("changeStyleChat")}},watch:{chosenStatus(){this.$emit("status",this.chosenStatus)},searchQuery(e){this.$emit("updateSearchQuery",e)}}};const es=(0,b.Z)(We,[["render",Xe],["__scopeId","data-v-88588c44"]]);var ss=es;const ts=e=>((0,i.dD)("data-v-711bcf81"),e=e(),(0,i.Cn)(),e),as={class:"client-list"},is={key:0,class:"client-list__loader"},ns=["onClick"],ls=ts((()=>(0,i._)("div",{class:"client-list__client-img"},[(0,i._)("img",{src:"https://ptetutorials.com/images/user-profile.png",alt:"sunil"})],-1))),os={class:"client-list__last-message"},rs={key:0},hs={key:1},ds={class:"client-list__observer",ref:"observer"};function cs(e,s,t,n,l,o){return(0,i.wg)(),(0,i.iD)("div",as,[(0,i.Wm)(a.W3,{name:"fade"},{default:(0,i.w5)((()=>[l.isLoading?((0,i.wg)(),(0,i.iD)("div",is)):((0,i.wg)(!0),(0,i.iD)(i.HY,{key:1},(0,i.Ko)(o.searchedList,(e=>((0,i.wg)(),(0,i.iD)("div",{class:(0,h.C_)(["client-list__client-card",e.id===l.chsAct?"active_chat":null]),key:e.id,onClick:s=>o.chosenUser(e.id)},[ls,(0,i._)("div",os,[(0,i._)("h5",null,[(0,i.Uk)((0,h.zw)(e.name)+" ",1),(0,i._)("span",null,(0,h.zw)(e.last_message.date.slice(0,-3)),1)]),""!==e.last_message.message&&null!==e.last_message.message?((0,i.wg)(),(0,i.iD)("p",rs,(0,h.zw)(e.last_message.message),1)):((0,i.wg)(),(0,i.iD)("p",hs,"[Вложение]"))])],10,ns)))),128))])),_:1}),(0,i._)("div",ds,null,512)])}var gs={mixins:[r],data(){return{clientPages:1,currentClientPage:0,maxClientsPerPage:10,clientDataList:[],chsAct:null,fullClientDataList:[],isLoading:!0,searchQuery:""}},props:{chosenStatus:{type:Number,default:1},searchQuery:{type:String,default:""},isMessageOpen:{type:Boolean,default:!1},newLastMessage:{type:Object,default:{}},newClient:{type:Object,default:{}},endDialogUserId:{type:Number,default:null},searchText:{type:String,default:""}},methods:{paginationOut(e){console.log("Количество клиентов "+e),this.clientPages=Math.ceil(e/this.maxClientsPerPage)},chosenUser(e){this.chsAct=e,this.$emit("openMessage",e)},async endDialog(e){if(confirm("Вы уверены что хотите закончить диалог с пользователем?")){let s={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{status:"Disabled",id:e}};await v().post(`${this.myProxy}/api/users/new/status`,null,s).then((e=>{console.log(e)}));for(let t=0;t<this.clientDataList.length;t++)this.clientDataList[t].id===e&&(console.log(t),this.clientDataList.splice(t,1))}},addNewClient(e){if(console.log(e),e.new_chat){const s={id:e.user_id,name:e.name,status:"Actived",role:"User",date:e.date,last_message:e};this.clientDataList.unshift(s)}for(let s=0;s<this.clientDataList.length;s++)this.clientDataList[s].id===e.user_id&&(this.clientDataList[s].last_message=e)},async apiCallClients(){console.log("I am calling"),this.clientDataList=[],this.fullClientDataList=[];const e={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"}};let s="";switch(this.chosenStatus){case 1:s="Actived";break;case 2:s="Disabled";break;case 3:s="Banned";break}await v().get(`${this.myProxy}/api/users/all/status?status=${s}`,e).then((e=>{console.log(e),this.paginationOut(e.data.length);for(let s=0;s<e.data.users.length;s++)this.fullClientDataList.push(e.data.users[s]);this.loadMoreClients()}))},updateLastMessage(e){for(let s=0;s<this.clientDataList.length;s++)this.clientDataList[s].id==e.user_id&&(this.clientDataList[s].last_message=e);this.sortClientListByDate()},sortClientListByDate(){this.clientDataList.sort(((e,s)=>Date.parse(s.last_message.date)-Date.parse(e.last_message.date)))},loadMoreClients(){console.log("яродился");const e=this.clientDataList.length;let s=this.clientDataList.length+this.maxClientsPerPage;this.fullClientDataList.length-e<this.maxClientsPerPage&&(s=e+(this.fullClientDataList.length-e));for(let t=e;t<s;t++)this.clientDataList.push(this.fullClientDataList[t]);this.isLoading=!1}},mounted(){this.apiCallClients();const e={rootMargin:"0px",threshold:0},s=(e,s)=>{e[0].isIntersecting&&this.loadMoreClients()},t=new IntersectionObserver(s,e);t.observe(this.$refs.observer)},watch:{chosenStatus(){this.currentClientPage=1,this.apiCallClients()},currentClientPage(){this.apiCallClients()},newLastMessage(e){this.updateLastMessage(e)},newClient(e){this.addNewClient(e)},endDialogUserId(e){for(let s=0;s<this.clientDataList.length;s++)this.clientDataList[s].id===e&&(console.log(s),this.clientDataList.splice(s,1))},searchText(e){this.searchQuery=e}},computed:{searchedList(){return""===this.searchQuery?[...this.clientDataList]:[...this.clientDataList].filter((e=>e.name.toLowerCase().includes(this.searchQuery.toLowerCase())))}}};const us=(0,b.Z)(gs,[["render",cs],["__scopeId","data-v-711bcf81"]]);var ms=us;const ps=e=>((0,i.dD)("data-v-8abf7520"),e=e(),(0,i.Cn)(),e),_s={key:0,class:"butt"},fs={class:"message-history",ref:"chatter"},ws={key:0,class:"message-history__loader"},vs={key:0,class:"message-history__incoming-msg_img"},Cs=ps((()=>(0,i._)("img",{src:"https://ptetutorials.com/images/user-profile.png",alt:"sunil"},null,-1))),ys=[Cs],bs={key:0,class:"message-history__message-inner-file"},ks=["href"],Ms=["src"],Ss=["href"],Ls=ps((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-file-earmark-arrow-down",viewBox:"0 0 16 16"},[(0,i._)("path",{d:"M8.5 6.5a.5.5 0 0 0-1 0v3.793L6.354 9.146a.5.5 0 1 0-.708.708l2 2a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 10.293V6.5z"}),(0,i._)("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"})],-1))),Is=ps((()=>(0,i._)("br",null,null,-1))),Us={class:"message-history__time-date"};function Os(e,s,t,a,n,l){return(0,i.wg)(),(0,i.iD)(i.HY,null,[1===t.chosenStatus?((0,i.wg)(),(0,i.iD)("div",_s,[(0,i._)("button",{onClick:s[0]||(s[0]=(...e)=>l.endDialog&&l.endDialog(...e))},"Закрыть диалог"),(0,i._)("button",{onClick:s[1]||(s[1]=(...e)=>l.banUser&&l.banUser(...e))},"Забанить пользователя")])):(0,i.kq)("",!0),(0,i._)("div",fs,[n.isLoading?((0,i.wg)(),(0,i.iD)("div",ws)):((0,i.wg)(!0),(0,i.iD)(i.HY,{key:1},(0,i.Ko)(n.dialogMsgs,(s=>((0,i.wg)(),(0,i.iD)("div",{class:(0,h.C_)("Admin"===s.status?"message-history__outgoing-message":"message-history__incoming-msg")},["Admin"!==s.status?((0,i.wg)(),(0,i.iD)("div",vs,ys)):(0,i.kq)("",!0),(0,i._)("div",{class:(0,h.C_)("Admin"===s.status?"message-history__sent-message":"message-history__received-message")},[(0,i._)("div",{class:(0,h.C_)("Admin"===s.status?"message-history__sent-message":"message-history__received-withd-msg")},[(0,i._)("p",null,[(0,i.Uk)((0,h.zw)(s.message)+" ",1),0!==s.file.length?((0,i.wg)(),(0,i.iD)("span",bs,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.file,((t,a)=>((0,i.wg)(),(0,i.iD)("div",{key:t.id},[e.isImage(s.file[a].name)?((0,i.wg)(),(0,i.iD)("a",{key:0,href:l.getFiles(s.file[a].name),target:"_blank"},[(0,i._)("img",{src:l.getFiles(s.file[a].name)},null,8,Ms)],8,ks)):((0,i.wg)(),(0,i.iD)("a",{key:1,href:l.getFiles(s.file[a].name),target:"_blank"},[Ls,(0,i.Uk)((0,h.zw)(s.file[a].name)+" ",1),Is],8,Ss))])))),128))])):(0,i.kq)("",!0)]),(0,i._)("span",Us,(0,h.zw)(s.date.slice(0,-3)),1)],2)],2)],2)))),256))],512)],64)}var xs={mixins:[r],data(){return{dialogMsgs:[],isLoading:!0}},props:{chosenStatus:{type:Number,default:1},userId:{type:Number,default:null},sendMessage:{type:Object,default:{}}},methods:{async getMessages(e){const s={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{user_id:e}};await v().get(`${this.myProxy}/api/users/messages`,s).then((e=>{console.log(e.data),this.dialogMsgs=[];for(let s=0;s<e.data.length;s++)this.dialogMsgs.push(e.data[s]);this.isLoading=!1}))},addMessage(e){if(console.log(e.user_id),console.log(this.userId),e.user_id==this.userId){let s=[],t=0;e.file.length>0&&e.file.forEach((e=>{s.push({id:t,name:e}),t++})),e.file=s,this.dialogMsgs.push(e)}},getFiles(e){const s=this.myProxy+"/api/file/"+e;return s},async endDialog(){if(confirm("Вы уверены что хотите закончить диалог с пользователем?")){let e={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{status:"Disabled",id:this.userId}};await v().post(`${this.myProxy}/api/users/new/status`,null,e).then((e=>{console.log(e),this.$emit("endDialog",this.userId)}))}},async banUser(){if(confirm("Вы уверены что хотите заблокировать пользователем?")){let e={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{status:"Banned",id:this.userId}};await v().post(`${this.myProxy}/api/users/new/status`,null,e).then((e=>{console.log(e),this.$emit("endDialog",this.userId)}))}}},watch:{userId(e){this.isLoading=!0,this.getMessages(e)},dialogMsgs:{handler(e,s){setTimeout(this.scrollToEnd,200)},deep:!0},sendMessage(e){this.addMessage(e)}}};const Ds=(0,b.Z)(xs,[["render",Os],["__scopeId","data-v-8abf7520"]]);var Bs=Ds;const As=e=>((0,i.dD)("data-v-1cf1a07e"),e=e(),(0,i.Cn)(),e),Ts={class:"input-msg-write"},zs=As((()=>(0,i._)("i",{class:"fa fa-paper-plane-o","aria-hidden":"true"},null,-1))),Fs=[zs],Hs=As((()=>(0,i._)("label",{class:"input-msg-write__file-uploader",for:"file"},[(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"white",class:"bi bi-file-earmark-arrow-down",viewBox:"0 -4 10 20"},[(0,i._)("path",{d:"M8.5 6.5a.5.5 0 0 0-1 0v3.793L6.354 9.146a.5.5 0 1 0-.708.708l2 2a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 10.293V6.5z"}),(0,i._)("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"})])],-1))),$s={clas:"input-msg-write__file-button"},Ps={key:0},js={class:"input-msg-write__files_list"},Ns=["href"];function Vs(e,s,t,n,l,o){return(0,i.wg)(),(0,i.iD)("div",Ts,[(0,i.wy)((0,i._)("textarea",{onKeyup:s[0]||(s[0]=(0,a.D2)(((...e)=>o.sendMessage&&o.sendMessage(...e)),["enter"])),"onUpdate:modelValue":s[1]||(s[1]=e=>l.adminMsg=e),class:"input-msg-write__area",cols:"30",rows:"4",placeholder:"Введите сообщение"},null,544),[[a.nr,l.adminMsg]]),(0,i._)("button",{onClick:s[2]||(s[2]=(...e)=>o.sendMessage&&o.sendMessage(...e)),class:"input-msg-write__send-btn",type:"button"},Fs),Hs,(0,i._)("input",{type:"file",id:"file",onInput:s[3]||(s[3]=(...e)=>o.handleFileUpload&&o.handleFileUpload(...e)),ref:"file"},null,544),(0,i._)("div",$s,[l.files.length>0?((0,i.wg)(),(0,i.iD)("div",Ps,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.files,(e=>((0,i.wg)(),(0,i.iD)("div",js,[(0,i._)("a",{href:e.fileURL,target:"_blank"},(0,h.zw)(e.name)+" ",9,Ns)])))),256))])):(0,i.kq)("",!0)])])}var Zs={data(){return{adminMsg:"",files:[]}},props:{chsAct:{type:Number,default:null}},mixins:[r],methods:{async handleFileUpload(){let e=new FormData;e.append("file",this.$refs.file.files[0]),console.log(this.$refs.file.files[0]),await v().post(`${this.myProxy}/api/file/upload`,e,{headers:{"Content-type":"multipart/form-data"}}).then((s=>{console.log(s),console.log("Успешно отправлен файл");let t={name:s.data,file:e,fileURL:window.URL.createObjectURL(this.$refs.file.files[0])};this.files.push(t)})).catch((e=>{console.log(e)}))},sendMessage(){let e=[];if(this.files.length>0)console.log("with files"),this.files.forEach((s=>{e.push(s.name)})),""!==this.adminMsg&&(this.adminMsg=this.adminMsg.trim());else if(e=[],""===this.adminMsg||"\n"===this.adminMsg)return this.adminMsg="",void alert("Введите сообщение");let s={name:"Admin",user_id:this.chsAct,message:this.adminMsg,status:"Admin",date:this.dateFocuses(),file:e};this.$socket.emit("admin_send_message",s),console.log(s),this.$emit("updateLastMessage",s),this.adminMsg="",this.files=[],console.log("Сообщение отправлено")}}};const Es=(0,b.Z)(Zs,[["render",Vs],["__scopeId","data-v-1cf1a07e"]]);var Ys=Es;const Ks=e=>((0,i.dD)("data-v-6c78390e"),e=e(),(0,i.Cn)(),e),Rs={class:"style-changer"},Gs=["value"],Qs={key:1},qs=Ks((()=>(0,i._)("p",null,"У вас еще нет добавленных сайтов. Добавьте адрес хоста своего сайта",-1))),Js=[qs],Xs={class:"style-changer__site-creator"},Ws={class:"style-changer__site-creator__input"},et=Ks((()=>(0,i._)("label",{for:"urlText"},"Адрес сайта: ",-1))),st=Ks((()=>(0,i._)("label",{for:"urlText"},"Название сайта: ",-1))),tt={type:"submit"},at={class:"style-changer__twin-blocks"},it=Ks((()=>(0,i._)("label",{for:"mainColor"},"Основной цвет чата:",-1))),nt=Ks((()=>(0,i._)("label",{for:"mainColor"},"Основной текст чата:",-1))),lt=Ks((()=>(0,i._)("label",{for:"adminMsgBackCol"},"Цвет сообщений админа:",-1))),ot=Ks((()=>(0,i._)("label",{for:"adminMsgFontCol"},"Цвет текста сообщений админа:",-1))),rt=Ks((()=>(0,i._)("label",{for:"usernameColor"},"Цвет имён:",-1))),ht=Ks((()=>(0,i._)("label",{for:"mainBackColor"},"Цвет фона сообщений:",-1))),dt=Ks((()=>(0,i._)("h4",null,"Расположение на странице:",-1))),ct={class:"style-changer__position-choose"},gt=Ks((()=>(0,i._)("label",{for:"positionChatLeft"},"Слева",-1))),ut=Ks((()=>(0,i._)("label",{for:"positionChatRight"},"Справа",-1))),mt=Ks((()=>(0,i._)("h4",null,"Вид иконки:",-1))),pt={class:"style-changer__position-choose"},_t=Ks((()=>(0,i._)("label",{for:"circleType"},"Круглая",-1))),ft=Ks((()=>(0,i._)("label",{for:"defaultType"},"Стандарт",-1))),wt={key:0,type:"submit"},vt=Ks((()=>(0,i._)("div",{class:"style-changer__links"},[(0,i._)("a",{href:"https://github.com/sklizkiygad/chatPlugin",target:"_blank"},"Скачать файлы чата"),(0,i._)("p",null,"Для того чтобы чат заработал на сайте надо вставить этот скрипт перед закрывающимся тегом <\\body>"),(0,i._)("p",null,' <script src="./plugin/chat/startingScript.js"><\\script> ')],-1)));function Ct(e,s,t,n,l,o){const r=(0,i.up)("admin-user-chat-style");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",Rs,[l.sitesList.length>0?((0,i.wg)(),(0,i.iD)("select",{key:0,class:"style-changer__site-select",onChange:s[0]||(s[0]=(...e)=>o.changeOption&&o.changeOption(...e))},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.sitesList,(e=>((0,i.wg)(),(0,i.iD)("option",{value:e.id},(0,h.zw)(e.name),9,Gs)))),256))],32)):((0,i.wg)(),(0,i.iD)("div",Qs,Js)),(0,i.wy)((0,i._)("button",{class:"style-changer__delete-btn",onClick:s[1]||(s[1]=(...e)=>o.deleteSite&&o.deleteSite(...e))},"Удалить сайт",512),[[a.F8,l.sitesList.length>0]]),(0,i._)("div",Xs,[(0,i._)("form",{onSubmit:s[4]||(s[4]=(0,a.iM)(((...e)=>o.sendUrlSite&&o.sendUrlSite(...e)),["prevent"]))},[(0,i._)("div",Ws,[(0,i._)("div",null,[et,(0,i.wy)((0,i._)("input",{type:"text",id:"urlText",placeholder:"https://site.org","onUpdate:modelValue":s[2]||(s[2]=e=>l.siteUrl=e)},null,512),[[a.nr,l.siteUrl]])]),(0,i._)("div",null,[st,(0,i.wy)((0,i._)("input",{type:"text",id:"urlName",placeholder:"site","onUpdate:modelValue":s[3]||(s[3]=e=>l.siteName=e)},null,512),[[a.nr,l.siteName]])])]),(0,i.wy)((0,i._)("button",tt,"Добавить сайт",512),[[a.F8,""!==l.siteUrl&&""!==l.siteName]])],32)]),(0,i._)("form",{onSubmit:s[15]||(s[15]=(0,a.iM)(((...e)=>o.sendStyle&&o.sendStyle(...e)),["prevent"]))},[(0,i._)("div",at,[(0,i._)("div",null,[it,(0,i.wy)((0,i._)("input",{id:"mainColor","onUpdate:modelValue":s[5]||(s[5]=e=>l.mainColor=e),type:"color"},null,512),[[a.nr,l.mainColor]])]),(0,i._)("div",null,[nt,(0,i.wy)((0,i._)("input",{id:"mainTextColor","onUpdate:modelValue":s[6]||(s[6]=e=>l.mainTextColor=e),type:"color"},null,512),[[a.nr,l.mainTextColor]])]),(0,i._)("div",null,[lt,(0,i.wy)((0,i._)("input",{id:"adminMsgBackCol","onUpdate:modelValue":s[7]||(s[7]=e=>l.adminMsgBackCol=e),type:"color"},null,512),[[a.nr,l.adminMsgBackCol]])]),(0,i._)("div",null,[ot,(0,i.wy)((0,i._)("input",{id:"adminMsgFontCol","onUpdate:modelValue":s[8]||(s[8]=e=>l.adminMsgFontCol=e),type:"color"},null,512),[[a.nr,l.adminMsgFontCol]])]),(0,i._)("div",null,[rt,(0,i.wy)((0,i._)("input",{id:"usernameColor","onUpdate:modelValue":s[9]||(s[9]=e=>l.usernameColor=e),type:"color"},null,512),[[a.nr,l.usernameColor]])]),(0,i._)("div",null,[ht,(0,i.wy)((0,i._)("input",{id:"mainBackColor","onUpdate:modelValue":s[10]||(s[10]=e=>l.mainBackColor=e),type:"color"},null,512),[[a.nr,l.mainBackColor]])])]),dt,(0,i._)("div",ct,[(0,i._)("div",null,[gt,(0,i.wy)((0,i._)("input",{id:"positionChatLeft",value:"left",type:"radio","onUpdate:modelValue":s[11]||(s[11]=e=>l.chatPosition=e)},null,512),[[a.G2,l.chatPosition]])]),(0,i._)("div",null,[ut,(0,i.wy)((0,i._)("input",{id:"positionChatRight",value:"right",type:"radio","onUpdate:modelValue":s[12]||(s[12]=e=>l.chatPosition=e)},null,512),[[a.G2,l.chatPosition]])])]),mt,(0,i._)("div",pt,[(0,i._)("div",null,[_t,(0,i.wy)((0,i._)("input",{id:"circleType",value:"circle",type:"radio","onUpdate:modelValue":s[13]||(s[13]=e=>l.chatIconStyle=e)},null,512),[[a.G2,l.chatIconStyle]])]),(0,i._)("div",null,[ft,(0,i.wy)((0,i._)("input",{id:"defaultType",value:"default",type:"radio","onUpdate:modelValue":s[14]||(s[14]=e=>l.chatIconStyle=e)},null,512),[[a.G2,l.chatIconStyle]])])]),null!==l.currentSiteId?((0,i.wg)(),(0,i.iD)("button",wt,"Применить изменения")):(0,i.kq)("",!0)],32),vt]),(0,i.Wm)(r,{chatColor:l.mainColor,adminMsgBackground:l.adminMsgBackCol,adminMsgFont:l.adminMsgFontCol,usernameColor:l.usernameColor,chatPosition:l.chatPosition,chatBackgroundColor:l.mainBackColor,mainTextColor:l.mainTextColor,chatIconStyle:l.chatIconStyle},null,8,["chatColor","adminMsgBackground","adminMsgFont","usernameColor","chatPosition","chatBackgroundColor","mainTextColor","chatIconStyle"])],64)}const yt=e=>((0,i.dD)("data-v-4e7975fb"),e=e(),(0,i.Cn)(),e),bt={key:0},kt=["fill"],Mt=yt((()=>(0,i._)("path",{d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm5.904-2.803a.5.5 0 1 0-.707.707L9.293 10H6.525a.5.5 0 0 0 0 1H10.5a.5.5 0 0 0 .5-.5V6.525a.5.5 0 0 0-1 0v2.768L5.904 5.197z"},null,-1))),St=[Mt],Lt=(0,i.Uk)(" Жмакни "),It=["fill"],Ut=yt((()=>(0,i._)("path",{d:"M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"},null,-1))),Ot=yt((()=>(0,i._)("path",{d:"m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9.06 9.06 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.437 10.437 0 0 1-.524 2.318l-.003.011a10.722 10.722 0 0 1-.244.637c-.079.186.074.394.273.362a21.673 21.673 0 0 0 .693-.125zm.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6c0 3.193-3.004 6-7 6a8.06 8.06 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a10.97 10.97 0 0 0 .398-2z"},null,-1))),xt=[Ut,Ot],Dt={class:"header__buttons"},Bt=["fill"],At=yt((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M.172 15.828a.5.5 0 0 0 .707 0l4.096-4.096V14.5a.5.5 0 1 0 1 0v-3.975a.5.5 0 0 0-.5-.5H1.5a.5.5 0 0 0 0 1h2.768L.172 15.121a.5.5 0 0 0 0 .707zM15.828.172a.5.5 0 0 0-.707 0l-4.096 4.096V1.5a.5.5 0 1 0-1 0v3.975a.5.5 0 0 0 .5.5H14.5a.5.5 0 0 0 0-1h-2.768L15.828.879a.5.5 0 0 0 0-.707z"},null,-1))),Tt=[At],zt={class:"logout"},Ft=["fill"],Ht=yt((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0v-2z"},null,-1))),$t=yt((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"},null,-1))),Pt=[Ht,$t],jt={class:"user-message-history__messages-list current-user"},Nt={class:"user-message-history__messages-list__message-inner"},Vt={class:"user-message-history__messages-list"},Zt={class:"user-message-history__messages-list__message-inner"},Et={ref:"inpMes",rows:"2",cols:"4",placeholder:"Написать сообщение..."},Yt={class:"input-msg-form__butt"},Kt=yt((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"16",fill:"currentColor",class:"bi bi-arrow-right",viewBox:"0 0 16 16"},[(0,i._)("path",{"fill-rule":"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"})],-1))),Rt=[Kt],Gt=yt((()=>(0,i._)("input",{type:"submit",id:"subBut",value:"Отпр."},null,-1))),Qt=yt((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"16",fill:"currentColor",class:"bi bi-folder-symlink",viewBox:"0 0 16 16"},[(0,i._)("path",{d:"m11.798 8.271-3.182 1.97c-.27.166-.616-.036-.616-.372V9.1s-2.571-.3-4 2.4c.571-4.8 3.143-4.8 4-4.8v-.769c0-.336.346-.538.616-.371l3.182 1.969c.27.166.27.576 0 .742z"}),(0,i._)("path",{d:"m.5 3 .04.87a1.99 1.99 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14h10.348a2 2 0 0 0 1.991-1.819l.637-7A2 2 0 0 0 13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2zm.694 2.09A1 1 0 0 1 2.19 4h11.62a1 1 0 0 1 .996 1.09l-.636 7a1 1 0 0 1-.996.91H2.826a1 1 0 0 1-.995-.91l-.637-7zM6.172 2a1 1 0 0 1 .707.293L7.586 3H2.19c-.24 0-.47.042-.683.12L1.5 2.98a1 1 0 0 1 1-.98h3.672z"})],-1))),qt=[Qt];function Jt(e,s,t,n,l,o){return l.isHigh?((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,h.C_)(["admin-style-chat","left"===t.chatPosition?"positionLeft":"positionRight"]),style:(0,h.j5)({backgroundColor:t.chatColor})},[(0,i._)("header",null,[(0,i._)("button",Dt,[((0,i.wg)(),(0,i.iD)("svg",{onClick:s[2]||(s[2]=(...e)=>o.changeSize&&o.changeSize(...e)),xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:t.mainTextColor,class:"bi bi-arrows-angle-contract",viewBox:"0 0 16 16"},Tt,8,Bt))]),(0,i._)("button",zt,[((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:t.mainTextColor,class:"bi bi-box-arrow-in-right",viewBox:"0 0 16 16"},Pt,8,Ft))]),(0,i._)("h1",{class:"header__greeting",style:(0,h.j5)({color:t.mainTextColor})}," Здравствуйте, Дмитрий ",4)]),(0,i._)("section",{class:"user-message-history",style:(0,h.j5)({backgroundColor:t.chatBackgroundColor}),ref:"chatter"},[(0,i._)("div",jt,[(0,i._)("div",Nt,[(0,i._)("div",{class:"user-message-history__messages-list__message-inner__username",style:(0,h.j5)({color:t.usernameColor})},"Дмитрий",4),(0,i._)("div",{class:"user-message-history__messages-list__message-inner__content",style:(0,h.j5)({backgroundColor:t.chatColor})},[(0,i._)("p",{style:(0,h.j5)({color:t.mainTextColor})},"Привет",4)],4)])]),(0,i._)("div",Vt,[(0,i._)("div",Zt,[(0,i._)("div",{class:"user-message-history__messages-list__message-inner__username",style:(0,h.j5)({color:t.usernameColor})},"Админ",4),(0,i._)("div",{class:"user-message-history__messages-list__message-inner__content",style:(0,h.j5)({backgroundColor:t.adminMsgBackground})},[(0,i._)("p",{style:(0,h.j5)({color:t.adminMsgFont})},"Добрый вечер",4)],4)])])],4),(0,i._)("footer",null,[(0,i._)("form",{class:"input-msg-form",onSubmit:s[4]||(s[4]=(0,a.iM)((()=>{}),["prevent"]))},[(0,i._)("textarea",Et,null,512),(0,i._)("div",Yt,[(0,i._)("label",{style:(0,h.j5)({backgroundColor:t.chatColor,color:t.mainTextColor}),for:"subBut"},Rt,4),Gt,(0,i._)("label",{style:(0,h.j5)({backgroundColor:t.chatColor,color:t.mainTextColor}),for:"fileUp"},qt,4),(0,i._)("input",{ref:"file",id:"fileUp",type:"file",onClick:s[3]||(s[3]=(0,a.iM)((()=>{}),["prevent"]))},null,512)])],32)])],6)):((0,i.wg)(),(0,i.iD)("div",bt,["default"===t.chatIconStyle?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,h.C_)(["lowbeAdmin","left"===t.chatPosition?"positionLeft":"positionRight"]),style:(0,h.j5)({backgroundColor:t.chatColor}),onClick:s[0]||(s[0]=(...e)=>o.changeSize&&o.changeSize(...e))},[(0,i._)("p",{style:(0,h.j5)({color:t.mainTextColor})},[((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:t.mainTextColor,class:"bi bi-arrow-down-right-circle-fill",viewBox:"0 0 16 16"},St,8,kt)),Lt],4)],6)):(0,i.kq)("",!0),"circle"===t.chatIconStyle?((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,h.C_)(["lowbe-round-admin","left"===t.chatPosition?"positionLeft":"positionRight"]),style:(0,h.j5)({backgroundColor:t.chatColor}),onClick:s[1]||(s[1]=(...e)=>o.changeSize&&o.changeSize(...e))},[((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"65%",height:"65%",fill:t.mainTextColor,class:"bi bi-chat-dots",viewBox:"0 0 16 16"},xt,8,It))],6)):(0,i.kq)("",!0)]))}var Xt={data(){return{isHigh:!0}},components:{UserChatLow:ke},props:{chatColor:{type:String,default:"#7B68EE"},adminMsgBackground:{type:String,default:"#F3F3F3"},adminMsgFont:{type:String,default:"#000000"},usernameColor:{type:String,default:"#888888"},chatPosition:{type:String,default:"right"},chatBackgroundColor:{type:String,default:"#ffffff"},mainTextColor:{type:String,default:"#ffffff"},chatIconStyle:{type:String,default:"default"}},methods:{changeSize(){this.isHigh=!this.isHigh}}};const Wt=(0,b.Z)(Xt,[["render",Jt],["__scopeId","data-v-4e7975fb"]]);var ea=Wt,sa={data(){return{mainColor:"#7B68EE",mainBackColor:"#ffffff",chatPosition:"right",adminMsgBackCol:"#F3F3F3",adminMsgFontCol:"#000000",mainTextColor:"#ffffff",usernameColor:"#888888",sitesList:[],currentSiteId:null,settingsList:[],siteUrl:"",siteName:"",chatIconStyle:""}},components:{AdminUserChatStyle:ea},mixins:[r],methods:{async sendStyle(){let e=[this.mainColor,this.mainTextColor,this.adminMsgBackCol,this.adminMsgFontCol,this.usernameColor,this.mainBackColor,this.chatPosition,this.chatIconStyle],s=!0;for(let t=0;t<this.settingsList.length;t++){let a={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{site_id:this.currentSiteId,setting_id:this.settingsList[t].setting_id,value:e[t]}};console.log(a),await v().post(`${this.myProxy}/settings/connect_site`,null,a).then((e=>{console.log(e),s=!0})).catch((e=>{console.log(e),alert("Не удалось применить стили. Попробуйте позже"),s=!1}))}s&&alert("Изменения успешно применены")},async getSites(){await v().get(`${this.myProxy}/site/all`).then((e=>{this.sitesList=e.data,this.sitesList.length>0&&(this.currentSiteId=this.sitesList[0].id),this.getSiteStyle()}))},changeOption(e){this.settingsList=[],this.currentSiteId=e.target.value,this.getSiteStyle()},async getAllSettingsList(){this.settingsList=[];let e={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"}};await v().get(`${this.myProxy}/settings/all`,e).then((e=>{console.log("Все настройки");for(let s=0;s<e.data.length;s++)this.settingsList.push({setting_id:e.data[s].id,name:e.data[s].name,value:e.data[s].base_value})})),console.log(this.settingsList)},async getSiteStyle(){this.settingsList=[];let e={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{site_id:this.currentSiteId}};v().get(`${this.myProxy}/settings/connect_site`,e).then((e=>{for(let s=0;s<e.data.length;s++)this.settingsList.push({setting_id:e.data[s].setting_id.id,name:e.data[s].setting_id.name,value:e.data[s].value});this.settingsList.length>0&&(this.mainColor=this.settingsList[0].value,this.mainTextColor=this.settingsList[1].value,this.adminMsgBackCol=this.settingsList[2].value,this.adminMsgFontCol=this.settingsList[3].value,this.usernameColor=this.settingsList[4].value,this.mainBackColor=this.settingsList[5].value,this.chatPosition=this.settingsList[6].value,this.chatIconStyle=this.settingsList[7].value)}))},async addNewSiteSettings(e){await this.getAllSettingsList();let s=["#7B68EE","#ffffff","#F3F3F3","#000000","#888888","#ffffff","right","default"],t=!0;for(let a=0;a<s.length;a++){let t={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{site_id:e,setting_id:this.settingsList[a].setting_id,value:s[a]}};await v().post(`${this.myProxy}/settings/connect_site`,null,t).then((e=>{console.log(e)})).catch((e=>{console.log(e)}))}t?alert("Успешно добавлен сайт"):alert("Ошибка при добавлении сайта")},async sendUrlSite(){const e={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{url:this.siteUrl,name:this.siteName}};await v().post(`${this.myProxy}/site/`,null,e).then((e=>{console.log(e),this.addNewSiteSettings(e.data.id),this.getSites()})).catch((e=>{console.log(e),alert("Не удалось добавить сайт")})),this.siteUrl="",this.siteName=""},async deleteSite(){let e={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{id:this.currentSiteId}};await v()["delete"](`${this.myProxy}/site/`,e).then((e=>{console.log(e),alert("Сайт удален"),this.getSites()})).catch((e=>{console.log(e),alert("Ошибка удаления. Попробуйте позже")}))}},mounted(){this.getSites(),this.getAllSettingsList()}};const ta=(0,b.Z)(sa,[["render",Ct],["__scopeId","data-v-6c78390e"]]);var aa=ta,ia={components:{AdminClientsHeader:ss,AdminClientsList:ms,AdminMessages:Bs,AdminWriteMessage:Ys,AdminStyleChanger:aa},sockets:{connect:function(){console.log("socket connected")}},mixins:[r],data(){return{dn:"none",db:"flex",clientOpen:!0,chosenStatus:1,lastMessageToUpdate:null,messagesUserId:null,addNewUser:null,userIdEndDialog:null,newMessage:null,isMessageOpen:!1,searchQueryText:"",isChangingStyleOpen:!1}},methods:{openClients(e){this.clientOpen=e},toClose(){this.$emit("close")},changeStatus(e){this.chosenStatus=e,this.isMessageOpen=!1},openMessages(e){this.messagesUserId=e,this.isMessageOpen=!0},updateClientList(e){this.lastMessageToUpdate=e},searchRequest(e){this.searchQueryText=e},openChangeStyle(){this.isMessageOpen=!1,this.isChangingStyleOpen=!this.isChangingStyleOpen},messageResponse(){try{this.sockets.subscribe("admin_response",(e=>{e.new_chat?this.addNewUser=e:(this.lastMessageToUpdate=e,this.newMessage=e)}))}catch(e){alert("Проблемы с подключением"),console.log(e)}},endDialog(e){this.userIdEndDialog=e}},created(){this.messageResponse()}};const na=(0,b.Z)(ia,[["render",Fe],["__scopeId","data-v-0186b900"]]);var la=na;const oa=e=>((0,i.dD)("data-v-973fbce2"),e=e(),(0,i.Cn)(),e),ra={class:"registration-page"},ha={id:"registration-page__signin"},da=oa((()=>(0,i._)("button",{type:"submit"},"",-1)));function ca(e,s,t,n,l,o){return(0,i.wg)(),(0,i.iD)("div",ra,[(0,i._)("div",ha,[(0,i._)("form",{id:"registration-page__signin__form",onSubmit:s[2]||(s[2]=(0,a.iM)(((...e)=>o.logIn&&o.logIn(...e)),["prevent"])),autocomplete:"off"},[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>l.adminname=e),type:"text",id:"user",name:"user",placeholder:"username"},null,512),[[a.nr,l.adminname]]),(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>l.password=e),type:"password",id:"pass",name:"pass",placeholder:"password"},null,512),[[a.nr,l.password]]),da],32),(0,i._)("p",null,(0,h.zw)(l.errorAuth),1)])])}var ga={mixins:[r],components:{AdminChat:la},data(){return{adminname:null,password:null,adminId:null,isIn:null,connection:null,errorAuth:null}},methods:{async logIn(){if(this.adminname&&this.password&&""!==this.adminname&&""!==this.password){this.adminname=this.adminname.trim(),console.log("Starting");const e={name:this.adminname,password:this.password};await v().put(`${this.myProxy}/admin/login`,{},{params:e}).then((e=>{console.log(e),e.data.error?this.errorAuth="Неверный логин или пароль!":(sessionStorage.setItem("is_auth",e.data.auth.toString()),sessionStorage.setItem("user",JSON.stringify(e.data.user)),this.checkAuth())}))}else alert("Введите имя и пароль!")},checkAuth(){this.$emit("auth")}},mounted(){this.checkAuth()}};const ua=(0,b.Z)(ga,[["render",ca],["__scopeId","data-v-973fbce2"]]);var ma=ua,pa={mixins:[r],components:{AdminChat:la,registrationAdmin:ma},data(){return{isIn:!1}},methods:{checkAuth(){"true"===sessionStorage.getItem("is_auth")?this.isIn=!0:this.isIn=!1},adminClose(){sessionStorage.clear(),this.checkAuth(),this.adminname=null,this.password=null}},mounted(){this.checkAuth()}};const _a=(0,b.Z)(pa,[["render",Ie]]);var fa=_a,wa={components:{Chat:Le,AdminPanel:fa}};const va=(0,b.Z)(wa,[["render",n]]);var Ca=va,ya=t(119);const ba=[{path:"/",component:Le},{path:"/admin",component:fa}],ka=(0,ya.p7)({routes:ba,history:(0,ya.PO)("/")});var Ma=ka,Sa=t(760),La=t.n(Sa);const Ia=new(La())({debug:!0,connection:"http://31.28.9.200:23765"});var Ua=Ia;const Oa={state:()=>({mainColor:"#7B68EE",mainTextColor:"#ffffff",adminMsgBackCol:"#F3F3F3",adminMsgFontCol:"#000000",usernameColor:"#888888",mainBackColor:"#ffffff",currentSiteId:null,settingsList:[],chatPosition:"right",chatIconType:"default"}),mutations:{setmainColor(e,s){e.mainColor=s},setmainTextColor(e,s){e.mainTextColor=s},setadminMsgBackCol(e,s){e.adminMsgBackCol=s},setadminMsgFontCol(e,s){e.adminMsgFontCol=s},setusernameColor(e,s){e.usernameColor=s},setmainBackColor(e,s){e.mainBackColor=s},setcurrentSiteId(e,s){e.currentSiteId=s},pushSettingList(e,s){e.settingsList.push(s)},setchatIconType(e,s){e.chatIconType=s}},actions:{async getUserStyle({state:e,commit:s}){let t={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{site_id:e.currentSiteId}};await v().get("http://31.28.9.200:23765/settings/connect_site",t).then((t=>{for(let e=0;e<t.data.length;e++)s("pushSettingList",{setting_id:t.data[e].setting_id.id,name:t.data[e].setting_id.name,value:t.data[e].value});e.settingsList.length>0&&(s("setmainColor",e.settingsList[0].value),s("setmainTextColor",e.settingsList[1].value),s("setadminMsgBackCol",e.settingsList[2].value),s("setadminMsgFontCol",e.settingsList[3].value),s("setusernameColor",e.settingsList[4].value),s("setmainBackColor",e.settingsList[5].value),localStorage.setItem("chatPosition",e.settingsList[6].value),s("setchatIconType",e.settingsList[7].value),localStorage.setItem("chatIconType",e.settingsList[7].value))})).catch((e=>{console.log(e)}))},async getSiteId({state:e,dispatch:s,commit:t},a){const i={params:{url:`http://${a}`}};await v().get("http://31.28.9.200:23765/site/",i).then((t=>{e.currentSiteId=t.data.id,s("getUserStyle")})).catch((e=>{console.log(e)}))}},namespaced:!0};var xa=(0,C.MT)({modules:{styleForUser:Oa}});(0,a.ri)(Ca).use(Ma).use(Ua).use(xa).mount("#app")}},s={};function t(a){var i=s[a];if(void 0!==i)return i.exports;var n=s[a]={exports:{}};return e[a].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(s,a,i,n){if(!a){var l=1/0;for(d=0;d<e.length;d++){a=e[d][0],i=e[d][1],n=e[d][2];for(var o=!0,r=0;r<a.length;r++)(!1&n||l>=n)&&Object.keys(t.O).every((function(e){return t.O[e](a[r])}))?a.splice(r--,1):(o=!1,n<l&&(l=n));if(o){e.splice(d--,1);var h=i();void 0!==h&&(s=h)}}return s}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[a,i,n]}}(),function(){t.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(s,{a:s}),s}}(),function(){t.d=function(e,s){for(var a in s)t.o(s,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:s[a]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){var e={143:0};t.O.j=function(s){return 0===e[s]};var s=function(s,a){var i,n,l=a[0],o=a[1],r=a[2],h=0;if(l.some((function(s){return 0!==e[s]}))){for(i in o)t.o(o,i)&&(t.m[i]=o[i]);if(r)var d=r(t)}for(s&&s(a);h<l.length;h++)n=l[h],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(d)},a=self["webpackChunkchat"]=self["webpackChunkchat"]||[];a.forEach(s.bind(null,0)),a.push=s.bind(null,a.push.bind(a))}();var a=t.O(void 0,[998],(function(){return t(655)}));a=t.O(a)})();
//# sourceMappingURL=app.fbf23574.js.map